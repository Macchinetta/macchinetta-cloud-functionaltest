BEGIN;

DROP TABLE IF EXISTS SSMN_TRANSACTION_TOKEN CASCADE;
DROP SEQUENCE IF EXISTS SSMN_TRANSACTION_TOKEN_SEQUENCE CASCADE;

CREATE TABLE SSMN_TRANSACTION_TOKEN (
    TOKEN_NAME VARCHAR(256) NOT NULL,
    TOKEN_KEY VARCHAR(32) NOT NULL,
    TOKEN_VALUE VARCHAR(32) NOT NULL,
    SESSION_ID  VARCHAR(256) NOT NULL,
    SEQUENCE BIGINT,
    CONSTRAINT PK_TRANSACTION_TOKEN PRIMARY KEY (TOKEN_NAME, TOKEN_KEY, SESSION_ID)
);

CREATE INDEX TRANSACTION_TOKEN_INDEX_DELETE_OLDER on SSMN_TRANSACTION_TOKEN(TOKEN_NAME, SESSION_ID);
CREATE INDEX TRANSACTION_TOKEN_INDEX_DELETE_OLDER_SEQUENCE on SSMN_TRANSACTION_TOKEN(SEQUENCE);
CREATE INDEX TRANSACTION_TOKEN_INDEX_CLEAN on SSMN_TRANSACTION_TOKEN(SESSION_ID);

CREATE SEQUENCE SSMN_TRANSACTION_TOKEN_SEQUENCE;

COMMIT;